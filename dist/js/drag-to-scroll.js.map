{"version":3,"sources":["drag-to-scroll.js"],"names":["console","log","mindMapContainer","document","querySelector","mindMap","words","querySelectorAll","urlParams","URLSearchParams","window","location","search","urlX","get","urlY","dragging","startX","startY","scrollX","scrollY","lastWord","length","scrollTo","innerWidth","innerHeight","parseInt","style","left","top","startDrag","e","screenX","screenY","scrollLeft","scrollTop","doDrag","distanceX","distanceY","throttle","updateQueryVars","stopDrag","set","newRelativePathQuery","pathname","toString","history","replaceState","addEventListener"],"mappings":"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","sourcesContent":["// scroll to the center of the mind map\n(function () {\n\tconsole.log('drag-to-scroll');\n\n\tlet mindMapContainer = document.querySelector('.mind-map-container');\n\tlet mindMap = document.querySelector('.mind-map');\n\tlet words = document.querySelectorAll('.word');\n\n\tconst urlParams = new URLSearchParams(window.location.search);\n\tconst urlX = urlParams.get('x');\n\tconst urlY = urlParams.get('y');\n\n\tlet dragging = false;\n\tlet startX, startY, scrollX, scrollY;\n\n\tconsole.log('x & y from URL query get vars', urlX, urlY);\n\n\tif (urlX && urlY) {\n\t\t// if there's URL coordinates, scroll to where the URL says\n\t\tlet words = document.querySelectorAll('.word');\n\t\tlet lastWord = words[words.length - 1];\n\t\tmindMapContainer.scrollTo(urlX - window.innerWidth / 2, urlY - window.innerHeight / 2);\n\t} else if (words.length) {\n\t\t// if there are words in the system, scroll to last word\n\t\tlet lastWord = words[words.length - 1];\n\t\tmindMapContainer.scrollTo(parseInt(lastWord.style.left) - window.innerWidth / 2, parseInt(lastWord.style.top) - window.innerHeight / 2);\n\t} else {\n\t\t// no URL, no words, just scroll to center\n\t\tmindMapContainer.scrollTo(5000 - window.innerWidth / 2, 5000 - window.innerHeight / 2);\n\t}\n\n\tlet startDrag = function (e) {\n\t\tdragging = true;\n\t\t// console.log('startDrag', e);\n\t\tstartX = e.screenX;\n\t\tstartY = e.screenY;\n\t\tscrollX = mindMapContainer.scrollLeft;\n\t\tscrollY = mindMapContainer.scrollTop;\n\t\t// console.log(startX, startY, scrollX, scrollY);\n\t};\n\n\tlet doDrag = function (e) {\n\t\tif (!dragging) return;\n\t\tlet distanceX = e.screenX - startX;\n\t\tlet distanceY = e.screenY - startY;\n\t\t// console.log('distance travelled', distanceX, distanceY);\n\t\tmindMapContainer.scrollLeft = scrollX - distanceX;\n\t\tmindMapContainer.scrollTop = scrollY - distanceY;\n\t\tthrottle(updateQueryVars, 300);\n\t};\n\tlet stopDrag = function (e) {\n\t\tdragging = false;\n\t};\n\n\tlet updateQueryVars = function () {\n\t\t// console.log('throttled updateQueryVars');\n\t\turlParams.set('x', mindMapContainer.scrollLeft + window.innerWidth / 2);\n\t\turlParams.set('y', mindMapContainer.scrollTop + window.innerHeight / 2);\n\t\tvar newRelativePathQuery = window.location.pathname + '?' + urlParams.toString();\n\t\thistory.replaceState(null, '', newRelativePathQuery);\n\t};\n\n\tmindMap.addEventListener('mousedown', startDrag);\n\twindow.addEventListener('mousemove', doDrag);\n\twindow.addEventListener('mouseup', stopDrag);\n\twindow.addEventListener('mouseleave', stopDrag);\n\twindow.addEventListener('blur', stopDrag);\n\n\tmindMapContainer.addEventListener('scroll', throttle(updateQueryVars, 300));\n})();\n"],"file":"drag-to-scroll.js"}